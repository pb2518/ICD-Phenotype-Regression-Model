# Step 4: Regression Analysis Between Genotypes and ICD Phenotypes - Script Outline

In order to carry out the PheWAS association, the data sets (Genotype, and ‘Sex’ covariate Phenotype), were assigned to new corresponding variables names compatible with the PheWAS package functions. This was similarly conducted for the converted ICD coded Phenotype data. They (along with the converted ICD coded Phenotype data) were then put into data frames to reshape the format into an appropriate logical (TRUE/FALSE) and wide data table for each sample ID and presence of a particular ICD code, also for the package functionality. As count data was used over the preferred input of dates of occurrence, an aggregate function was also defined here for the phenotype variables (ICD codes and ‘Sex’). This process was used for mapping and aggregating codes to the package ‘phenocodes’, mapping and coalescing exclusions, and code counts as applicable, hence reshaping the data. The PheWAS regression analyses was then run using a results package function which joined the datasets by shared sample IDs, finding associations, compiling the results, cleaning up, finding significance thresholds, and outputting results as a table (.txt file). 